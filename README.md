# ya_events

Проект по получению данных (парсинг) с сайта мероприятий Яндекса "events.yandex.ru".
Создан адрес и представления для обработки запросов в приложении API. 


## Документация к API
Документация доступна по локальному адресу при запущенном проекте: http://127.0.0.1:8000/schema/


## Получение данных из внешних источников
Файл **events/api/get_data_parsing.py** содержит функции, необходимые для получения данных из внешнего источника.

| Функция                       | Описание                                                                              | Тип возвращаемых данных           |
|-------------------------------|:--------------------------------------------------------------------------------------|:----------------------------------|
| site_parsing()                | Получение данных сайта                                                                | bs4.element.Tag - **`str()`**       |
| date_converter()              | Конвертер строки к виду гггг-мм-дд                                                    | datetime ("%Y-%m-%d") - **`str()`** |
| processing_data_website()     | Обработка данных сайта после парсинга.<br/>Разделяем дату, название, сайт мероприятия | **`list()`**                        |

Подробную информацию о работе функций можно узнать из документации к ним.


## Описание функций телеграм-бота
Файл **events/tg_bot/management/commands/bot.py** содержит функции, необходимые для работы телеграм-бота.

| Функция                        | Описание                                                                                                | Тип возвращаемых данных |
|--------------------------------|:--------------------------------------------------------------------------------------------------------|:------------------------|
| process_information_parsing()  | Обработка информации после парсинга                                                                     | **`list[str]`**         |
| send_message()                 | Отправка сообщений.  Принимает текст сообщения и отправляет его в указанный чат                         | **`int`**               |
| all_events()                   | Обработка команды 'Все мероприятия'                                                                     | **`int`**               |
| checking_data_changes()        | Проверка изменений/обновлений данных с сайта                                                            | **`bool`**              |
| hi_say_first_message()         | Отправка первого сообщения                                                                              | **`None`**              |
| update_subscription_add_user() | Обновление подписки пользователя на получение обновлений                                                | **`int`**               |
| subscribe()                    | Подписка пользователя на получение обновлений                                                           | **`None`**              |
| unsubscribe()                  | Отписка пользователя от получений обновлений                                                            | **`None`**              |
| check_updates()                | Функция постоянно проверяет наличие изменений в данных и отправляет сообщения подписанным пользователям | **`None`**              |
| do_echo()                      | Обрабатывает текст, которого нет в командах                                                             | **`int`**               |


## Установка и запуск
Клонировать репозиторий и перейти в него в командной строке:

```
git clone https://github.com/MaximKotov-2022/ya_events/
```

```
cd ya_events
```

Cоздать и активировать виртуальное окружение:

```
python3 -m venv venv
```

```
source venv/bin/activate
```

```
python -m pip install --upgrade pip
```

Установить зависимости из файла requirements.txt:

```
pip install -r requirements.txt
```

Выполнить миграции:

```
python3 manage.py migrate
```

Запустить проект:

```
python3 manage.py runserver
```


## Используемые технологии
+ Python
+ Django REST Framework
+ JWT
+ Djoser
+ Github Actions


## Автор
+ **Котов Максим** [MaximKotov-2022](https://github.com/MaximKotov-2022)
